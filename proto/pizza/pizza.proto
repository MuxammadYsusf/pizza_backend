syntax = "proto3";

package pizza;

option go_package = "generated/pizza";
import "google/protobuf/timestamp.proto";

service PizzaService{
    rpc CreatePizza(CreatePizzaRequest) returns (CreatePizzaResponse);
    rpc CreatePizzaType(CreatePizzaRequest) returns (CreatePizzaResponse);
    rpc GetPizzas(GetPizzasRequest) returns (GetPizzasResponse);
    rpc GetPizzaById(GetPizzaByIdRequest) returns (GetPizzaByIdResponse);
    rpc UpdatePizza(UpdatePizzaRequest) returns (UpdatePizzaResponse);
    rpc DeletePizza(DeletePizzaRequest) returns (DeletePizzaResponse);
    rpc GetPizzaCost(CartItems) returns (CartItemsResp);
}

message CreatePizzaRequest {
    string name = 1;
    float price = 2;
    int32 typeId = 3;
    string photo = 4;
}

message CreatePizzaResponse {
    string message = 1;
}

message GetPizzasRequest {
    int32 typeId = 1;
}

message GetPizzasResponse {
    repeated Pizzas pizzas = 1;
}

message Pizzas {
    string name = 1;
    float price = 2;
    string photo = 3;
    int32 id = 4;
}

message GetPizzaByIdRequest {
    int32 id = 1;
    int32 typeId = 2;
}

message GetPizzaByIdResponse {
    string name = 1;
    float price = 2;
    string photo = 3;
}

message UpdatePizzaRequest {
    int32 id = 1;
    int32 typeId = 2;
    string name = 3;
    float price = 4;
    string photo = 5;
}

message UpdatePizzaResponse {
    string name = 1;
    float price = 2;
    string message = 3;
}

message DeletePizzaRequest {
    int32 id = 1;
    int32 typeId = 2;

}

message DeletePizzaResponse {
    string message = 1;
}

service CartService{
    rpc Cart(CartRequest) returns (CartResponse);
    rpc DecreasePizzaQuantity(CartItems) returns (CartItemsResp);
    rpc GetTotalCost(CartItems) returns (CartItemsResp);
    rpc GetCartHistory(GetCartHistoryRequest) returns (GetCartHistoryResponse);
    rpc GetCartItemHistory(GetCarItemtHistoryRequest) returns (GetCarItemtHistoryResponse);
}
message CheckIsCartExistRequest {
    int32 userId = 1;
    bool isActive = 2;
    int32 id = 3;
}

message CheckIsCartExistResponse {
    string message = 1;
    bool isActive = 2;
}

message CartRequest {
    int32 id = 1;
    int32 userId = 2;
    bool isActive = 3;
    float totalCost = 4;
    int32 cartItemId = 5;
    int32 pizzaId = 6;
    int32 pizzaTypeId = 7;
    float cost = 8;
    int32 quantity = 9;
    int32 cartId = 10;
    repeated CartItems items = 11;
}

message CartResponse {
    string message = 1;
}
message CartItems {
    float totalCost = 1;
    int32 id = 2;
    int32 pizzaId = 3;
    int32 pizzaTypeId = 4;
    float cost = 5;
    int32 quantity = 6;
    int32 cartId = 7;
    int32 userId = 8;
    repeated CartItems items = 9;
}

message CartItemsResp {
    int32 id = 1;
    string message = 2;
    int32 cartId = 3;
    int32 pizzaId = 4;  
    float cost = 5;
    int32 quantity = 6;
    int32 pizzaTypeId = 7;
    float totalCost = 8;
    repeated CartItems cartItems = 9;
}

message GetCartHistoryRequest {
    int32 cartId = 1;
    int32 userId = 2;
}

message GetCartHistoryResponse {
    int32 cartId = 1;
    google.protobuf.Timestamp date = 2;
    int32 userId = 3;
    bool isActive = 4;
    repeated GetCartHistoryResponse cartHistory = 5;
}

message GetCarItemtHistoryRequest {
    int32 cartHistoryId = 1;
}

message GetCarItemtHistoryResponse {
    int32 cartHistoryId = 1;
    int32 pizzaId = 2;
    int32 pizzaTypeId = 3;
    float cost = 4;
    int32 quantity = 5;
    repeated GetCarItemtHistoryResponse cartHistory = 6;
}

service OrderService{
    rpc CheckIsOrdered(CheckIsOrderedRequest) returns (CheckIsOrderedResponse);
    rpc OrderPizza(OrderPizzaRequest) returns (OrderPizzaResponse);
}
message CheckIsOrderedRequest {
    int32 userId = 1;
    bool isOrdered = 2;
    int32 id = 3;
}

message CheckIsOrderedResponse {
    string message = 1;
    bool isOrdered = 2;
    string status = 3;
}

message OrderItemData{
    int32 pizzaId = 1;
    int32 quantity = 2;
    repeated int32 itemIds = 3;
}

message OrderPizzaRequest {
    int32 id = 1;
    google.protobuf.Timestamp date = 2;
    bool isOrdered = 3;
    int32 userId = 4;
    string status = 5;
    repeated int32 itemIds = 6;
    int32 pizza_id = 7;
    repeated float cost = 8;
    int32 cart_id = 9;
    int32 quantity = 10;
    bool isExist = 11;
    int32 limit = 12;
    repeated OrderItemData items = 13;
}

message OrderPizzaResponse {
    string message = 1;
    string status = 2;
    int32 id = 3;
    repeated int32 itemIds= 4;
    google.protobuf.Timestamp date = 5;
    bool isExist = 6;
    repeated float cost = 7;
}
